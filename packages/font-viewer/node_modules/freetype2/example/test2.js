var fs = require('fs');
var ft2 = require('../build/Release/freetype2');
var fontface = ft2.New_Memory_Face(fs.readFileSync(process.argv[2]), 0); // 0: index of the face. font might hold multiple faces

var charCodes = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('').map(function(c) { return c.charCodeAt(0); });

ft2.Set_Char_Size(fontface, 0, 60 << 6, 0, 0);

var renderBitmap = function(bitmap) {
  for (var i = 0; i < bitmap.buffer.length; i++) {
    if (i % bitmap.pitch === 0) console.log('');
    process.stdout.write(('        ' + bitmap.buffer.readUInt8(i).toString(2).replace(/0/g, ' ').replace(/1/g, 'â–ˆ')).substr(-8, 8));
  }

  console.log('');
};

var bitmaps = charCodes.map(function(ch) {
  ft2.Load_Char(fontface, ch, ft2.LOAD_DEFAULT);
  ft2.Render_Glyph(fontface.glyph, ft2.RENDER_MODE_MONO);
  return fontface.glyph.bitmap;
});

bitmaps.forEach(function(bmp) {
  renderBitmap(bmp);
});
